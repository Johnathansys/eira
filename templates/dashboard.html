<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/static/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <title>Eira - Dashboard</title>
</head>

<body>
    <header>
        <img src="/static/eiralogo.png" alt="Eira Logo" class="logo">
        <nav class="navbar">
            <h1 class="nav-left">Eira!</h1>
            <div>
                <a href="/dashboard">Dashboard</a>
                <a href="/logout">Logout</a>
            </div>
        </nav>
    </header>

    <div class="main-content">
        <section class="intro">
            <h2>Welcome back, <span style="color: #00e9e5; font-weight: 700;">{{ username }}</span>!</h2>
            <p>Ready to reflect and grow? Here's your personal hub.</p>
        </section>

        <!-- NEW: Mood trend chart -->
        <div class="chart-container">
            <h3>üß† Your Mood Over Time</h3>
            <canvas id="moodChart"></canvas>
        </div>
        <!-- END NEW -->

        <div class="dashboard-container">
            <a href="/journal_entry" class="intro dashboard-link-item">
                <h3>‚úçÔ∏è New Journal Entry</h3>
                <p>Start writing down your thoughts and feelings.</p>
            </a>
            <a href="/history" class="intro dashboard-link-item">
                <h3>üìñ Journal History</h3>
                <p>Review and reflect on past entries.</p>
            </a>
            <a href="/calendar" class="intro dashboard-link-item">
                <h3>üóìÔ∏è Calendar View</h3>
                <p>Visualize your progress over time.</p>
            </a>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 Mental Health Hub. All rights reserved.</p>
    </footer>

    <!-- NEW: Chart.js script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const ctx = document.getElementById('moodChart').getContext('2d');
            const moodChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: {{ recent_dates | tojson }},
                    datasets: [{
                        label: 'Mood Rating',
                        data: {{ recent_moods | tojson }},
                        borderColor: '#00e9e5',
                        backgroundColor: 'rgba(0, 233, 229, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 10,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
        });
    </script>
    <!-- END NEW -->
</body>
</html>
